# -- Help ---------------------------------------------------------------------

# The tmux manual `man tmux` has all the information.

# `<prefix>-C`
#    See all current configurations and keymappings, as as well as the original
#    mapping and the one that may have overwritten it.

# `<prefix>-?`
#    List all key bindings

# Read the "KEY BINDINGS" section of `man tmux`:
#   - The "prefix" table is the default (no flag).
#   - `-n` = "root" table (direct bind, no prefix required).
#   - `-T  = "custom" table (use `switch-client -T` to switch to that table)
#   - `-r` = means repeatable, see `repeat-time`
#   - `-N` attaches a note to the key, shown with `list-keys -N`

# -- Key bindings -------------------------------------------------------------

# Change default prefix:
# unbind C-b
# set -g prefix C-space
# bind C-space send-prefix

# Reload config:
bind r run-shell "tmux source-file $HOME/.config/tmux/tmux.conf; tmux display-message 'Tmux configuration reloaded'"

# SESSION KEYBINDINGS:

bind C-n run-shell "tmux-sessionizer ~/.local/share/mynix"
bind C-o run-shell "tmux-sessionizer ~/projects/omarchy"
bind C-h run-shell "tmux-sessionizer ~"

# WINDOW KEYBINDINGS:

bind -r n next-window       # make default repeatable
bind -r p previous-window   # make default repeatable

bind -r N swap-window -d -t '+1'   # easier window move
bind -r P swap-window -d -t '-1'   # easier window move

# PANE KEYBINDINGS:

bind \" split-window -v -c "#{pane_current_path}"   # make default preserve path
bind % split-window -h -c "#{pane_current_path}"    # make default preserve path

bind j select-layout even-vertical     # same as hyprland
bind k select-layout even-horizontal   # unfortunatelly cannot togge with j

bind -r \; last-pane   # make default repeatable


# --- Options -----------------------------------------------------------------

#     Increase/decrease repetition time (default 500)
# set -g repeat-time 500

#     Fix delay on vim to go back to normal mode when pressing esc
#     http://superuser.com/a/252717/65504
set -g escape-time 0

#     Fix image preview for Yazi insize tmux
#     https://github.com/sxyazi/yazi/wiki/Image-preview-within-tmux
set -g allow-passthrough on
set -ga update-environment TERM
set -ga update-environment TERM_PROGRAM

#     Fix colors and italics for most terminal emulators
#     https://gist.github.com/andersevenrud/015e61af2fd264371032763d4ed965b6
set -g default-terminal "tmux-256color"
set -ga terminal-overrides ",xterm-256color:RGB"

#     Increase tmux messages display duration (default 750ms)
set -g display-time 4000

#     Increase display panes time
set -g display-panes-time 10000

#     Increase scrollback buffer size (default 2000)
set -g history-limit 5000

#     Enable mouse
set -g mouse on

#     Disable normal mode in tmux command line:
set -g status-keys emacs

#     Focus events enabled for terminals that support them
#set -g focus-events on

#     Refresh 'status-left' and 'status-right' more often, from every 15s to 5s
#set -g status-interval 5

#     Super useful when using "grouped sessions" and multi-monitor setup
#set -g aggressive-resize on

#     Numbering windowns and panes
set -g base-index 1 # make windows start at 1 (default 0)
set -g pane-base-index 1 # make panes start at 1 (default 0)
set -g renumber-windows on # automatically renumber windows when moved or deleted
set -g automatic-rename on # let programs automatically rename a window

#     Vim-like copy mode
set -g mode-keys "vi"
bind -T copy-mode-vi v send-keys -X begin-selection
bind -T copy-mode-vi C-v send-keys -X rectangle-toggle
bind -T copy-mode-vi y send-keys -X copy-selection-and-cancel

#     Correct scrolling behavior (act the same as the terminal without tmux,
#     otherwise it scrolls almost half a page with a minimum movement)
bind -T copy-mode-vi WheelUpPane   send-keys -X scroll-up
bind -T copy-mode-vi WheelDownPane send-keys -X scroll-down


# --- Theme -------------------------------------------------------------------
#     https://github.com/tmux/tmux/wiki/Getting-Started#list-of-style-and-format-options

#     Left secction (session-name)
# set -g status-left " #{session_name}"
# set -g status-left-length "100"

#     Middle section (windows)
# set -g status-justify "absolute-centre"
# set -g window-status-separator "   "
# set -g window-status-format "#I:#W#{?window_marked_flag,!,}#{?window_zoomed_flag,(Z),}"
# set -g window-status-current-format "#I:#W#{?window_marked_flag,!,}#{?window_zoomed_flag,(Z),}"

#     Right section (remove clock and hostname info)
# set -g status-right '%d-%b  %H:%M '
set -g status-right ''

#     Load theme
# source-file $HOME/.config/mynix/current/theme/tmux.conf
